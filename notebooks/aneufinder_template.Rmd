---
title: "`r params$report_title`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: united
    code_folding: hide
params:
  report_title: "Check aneuploidy in RNAseq samples"
  report_author: "Anonymus"
  bam_folder: "../test_data/samples_list.csv"
  sample_metadata: "../test_data/samples_meta.csv"
  condition_column: "Label"
  condition_order: null
  species: "hs"
---

## Setup

### Initialize tools

```{r message=FALSE, warning=FALSE}
# Import packages

library(tidyr)
library(purrr)
library(ggplot2)
library(ggsci)
library(ggridges)
library(plotly)
library(pheatmap)
library(DT)
library(AneuFinder)
```

```{r}
Aneufinder(
  inputfolder=params$bam_folder, outputfolder='aneu_out',
  numCPU=2, method=c('edivisive', 'dnacopy', 'HMM')
)
```

```{r}
files <- list.files('/home/rstudio/local_files/data/aneu_out/MODELS/method-edivisive', full.names=TRUE)
hmms <- loadFromFiles(files)
```

```{r}
cl <- clusterByQuality(hmms)
heatmapGenomewide(cl$classification[[1]])
```

```{r}
getBreakpoints(hmms[[1]])
```

```{r}
plot(files[1], type='karyogram')
```

```{r}
plot(files[1], type='profile')
```

```{r fig.width=16, fig.height=9}
heatmapGenomewide(hmms, cluster=FALSE)
```

```{r fig.width=16, fig.height=9}
aneu_df <- heatmapAneuploidies(hmms, as.data.frame=TRUE)
head(aneu_df)
```
